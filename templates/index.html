{% extends "layout.html" %}

{% block title %}
    World Mood
{% endblock %}

{% block main %}
	<div class="header mt-4">
		<h1>Mood Ring</h1>
		<nav class="navbar navbar-expand-sm navbar-light">
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse justify-content-center" id="collapsibleNavbar">
				<ul class="navbar-nav">
					<li class="nav-item">
						<a class="nav-link active" href="/">World Mood</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="/add_entry">Add Your Entry</a>
					</li> 
				</ul>
			</div>  
		</nav>
	</div>
	<div class="page-body section1">
		<h2>Current World Mood</h2>
		<div class="graph">
			<div class="row">
				<div class="col-md-3"></div>
				<div class="col-md-6">
					<div class="chart" id="bargraph">
						<script type="text/javascript">
							//@ts-ignore
							var graphs = {{plot|safe}};
							Plotly.plot('bargraph',graphs,{});
						</script>
					</div>
				</div>
				<div class="col-md-3"></div>
			</div>
		</div>
	</div>
	<div class="page-body section2">
		<h3>Recent Entries</h3>
		<div class="row">
			<div class="col-md-4"></div>
			<div class="col-md-4 justify-content-center text-center">
				<ul class="legend mb-4 pb-5">
					<li><span id="positive-key"></span>Positive</li>
					<li><span id="negative-key"></span>Negative</li>
				</ul>
			</div>
			<div class="col-md-4"></div>
		</div>
		<div class="row">
			<div class="col-md-3"></div>
			<div id="recent-entries" class="col-md-6"></div>
			<div class="col-md-3"></div>
		</div>
		<script>
			var entry_list = {{ arr_entries|tojson }};
			for(var i = 0; i < entry_list.length; i ++) {
				var newEntry = document.createElement('div');
				if(entry_list[i][2] === -1) {
					newEntry.className = "one-entry negative"
				}
				else {
					newEntry.className = "one-entry positive"
				}
				var date = document.createElement("p");
				date.className = "date-text"
				var dateTextNode = document.createTextNode(entry_list[i][0]);
				date.appendChild(dateTextNode);
				var msg = document.createElement("p");
				var textnode = document.createTextNode(entry_list[i][1]);
				msg.appendChild(textnode);
				newEntry.appendChild(date);
				newEntry.appendChild(msg);
				document.getElementById("recent-entries").appendChild(newEntry);
			}
		</script>
	</div>
	<script src="{{url_for('static', filename='myScript.js')}}"></script>
{% endblock %}